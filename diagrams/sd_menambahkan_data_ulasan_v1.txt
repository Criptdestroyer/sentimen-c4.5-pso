@startuml
hide footbox
title Menambahkan Data Ulasan\n

actor Peneliti
boundary AppWindow
control MainControl
control importer
control "preprocessor : Preprocessor"
entity "db : Database"

activate Peneliti
Peneliti -> AppWindow : importExcel()
activate AppWindow
AppWindow -> MainControl : importExcel()
activate MainControl
MainControl -> MainControl : openFileDialog()

alt "file exist?"
create importer
MainControl -> importer : << DataImporter(filename) >>
activate importer
importer --> MainControl : DataFrame
deactivate importer
MainControl --> AppWindow : DataFrame
else
MainControl --> AppWindow : None
end

deactivate MainControl
opt "is data not empty?"
AppWindow -> AppWindow : renderTable(data)
end

Peneliti -> AppWindow : preprocessData()
AppWindow -> MainControl : preprocessData(data)
activate MainControl
loop "review in data"
MainControl -> "preprocessor : Preprocessor" : preprocess(review)
activate "preprocessor : Preprocessor"
"preprocessor : Preprocessor" -> "preprocessor : Preprocessor" : stemming()
"preprocessor : Preprocessor" -> "preprocessor : Preprocessor" : tokenizing()
"preprocessor : Preprocessor" -> "preprocessor : Preprocessor" : removing_stopwords()
end

deactivate "preprocessor : Preprocessor"
deactivate MainControl

Peneliti -> AppWindow : saveData()
AppWindow -> MainControl : saveData()
activate MainControl
MainControl -> "db : Database" : multiplesql()
activate "db : Database"
@enduml